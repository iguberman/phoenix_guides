####Example: Create a model with custom primary key `name:string` instead of autogenerated `id:integer`

IMPORTANT NOTE: this example was chosen for simplicity.  It is not advisable to use something that is likely to change
in the future as primary key.  

Create project named chat:

>`mix phoenix.new chat`

>`mix ecto.create`

To create User model run: 

>`mix phoenix.gen.json User users name:string age:integer`

Modify 4 generated files:

**1. Modify models/user.ex like so:**

* Add `@primary_key {:name, :string, []}` right above `schema "users" do` and remove `field :name` from below it:
```
@primary_key {:name, :string, []}  # ADDED THIS LINE
schema "users" do
  #field :name, :string  REMOVED THIS LINE
  field :age, :integer

  timestamps
end
```
    
* Add below code somewhere in this file to be able to specify name instead of id in the URL.
    Based on this example https://github.com/gjaldon/phoenix_params
```
defimpl Phoenix.Param, for: Chat.User do 
    def to_param(user) do
        user.name
   end
end
```
And below is another modification we need to be able to specify name instead of id in the URL
(again, based on https://github.com/gjaldon/phoenix_params)

**2. Modify web/controllers/user_controller.ex show, update, and delete methods**

NOTE the use of `Repo.get_by` instead of `Repo.get` and `name: name` instead of `id`
```
def show(conn, %{"id" => name}) do
    user = Repo.get_by!(User, name: name) 
...
```
```
def update(conn, %{"id" => name, "user" => user_params}) do
    user = Repo.get_by!(User, name: name) 
...
```
```
 def delete(conn, %{"id" => name}) do
    user = Repo.get_by!(User, name: name) 
...
```
**3. Modify migrations/*yyyymmddHHMMSS*_create_user.exs like so:**
```
def change do
    create table(:users, primary_key: false) do # ADDED "primary_key: false"
      add :name, :string, primary_key: true    # ADDED "primary_key: true"
      add :age, :integer
      timestamps
    end
```

**4. Remove `id` from `render` in views/user_view.ex:**
```
def render("user.json", %{user: user}) do
    %{# id: user.id,   REMOVED THIS entry
      name: user.name,
      age: user.age
     }
end
```

Run:
>`mix ecto.migrate`

Resulting `users` table will have the following schema:
```
CREATE TABLE users
(
  name character varying(255) NOT NULL,
  age integer,
  inserted_at timestamp without time zone NOT NULL,
  updated_at timestamp without time zone NOT NULL,
  CONSTRAINT users_pkey PRIMARY KEY (name)
)
```

Now we have a model with primary key `name` and we can query users by name i.e. `localhost:4000/users/iguberman`

